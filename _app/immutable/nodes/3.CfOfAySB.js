var St=n=>{throw TypeError(n)};var Dt=(n,e,r)=>e.has(n)||St("Cannot "+r);var G=(n,e,r)=>(Dt(n,e,"read from private field"),r?r.call(n):e.get(n)),M=(n,e,r)=>e.has(n)?St("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,r);var gt=(n,e,r)=>(Dt(n,e,"access private method"),r);import{c as o,r as i,a as w,t as V,b as U,n as It,s as t,f as A,w as dt,p as bt,o as F}from"../chunks/disclose-version.CqyMsf3s.js";import{z as I,g as c,B as S,p as B,f as K,t as R,I as at,u as Wt,n as H}from"../chunks/runtime.DkqSkKrO.js";import{i as rt}from"../chunks/this.DlH2oH7g.js";import{b as Vt,s as mt,a as L,n as $t,r as Q}from"../chunks/index.17Etm3vo.js";import{b as ut,a as Ft,G as $,d as yt,f as ft,N as wt,W as Ht,E as Rt,t as Nt,s as Ot}from"../chunks/themeOptions.svelte.DO0JJB9t.js";import{a as h,p as _t}from"../chunks/props.DlkvsI11.js";const Gt=async({fetch:n})=>{const a=await(await n("https://my.api.mockaroo.com/geosales.json?key=a53dac10")).json();return qt(a)};function qt(n){const e={},r=[];for(let a of n){const s=e[a.country_code]=e[a.country_code]??{country_name:a.country_name,country_code:a.country_code,quantity_sold:0,sales_amount:0,total_costs:0,total_sales:0};s.quantity_sold+=a.quantity_sold,s.sales_amount+=a.sales_amount,s.total_costs+=a.total_costs,s.total_sales+=a.total_sales;let l=r.find(v=>v.country_code===a.country_code&&v.city===a.city);l||(l={country_code:a.country_code,country_name:a.country_name,city:a.city,quantity_sold:0,sales_amount:0,total_costs:0,total_sales:0},r.push(l)),l.quantity_sold+=a.quantity_sold,l.sales_amount+=a.sales_amount,l.total_costs+=a.total_costs,l.total_sales+=a.total_sales}return{detail:n,byCity:r,byCountry:Object.keys(e).map(a=>e[a])}}const ke=Object.freeze(Object.defineProperty({__proto__:null,load:Gt},Symbol.toStringTag,{value:"Module"}));var nt;class At{constructor(){M(this,nt,I(!0))}get noViewportInChildren(){return c(G(this,nt))}set noViewportInChildren(e){S(G(this,nt),h(e))}}nt=new WeakMap;const pt=new At,Y=new Intl.NumberFormat(navigator==null?void 0:navigator.language,{style:"currency",currency:"USD",currencyDisplay:"narrowSymbol"});function X(n){return new Intl.NumberFormat(navigator==null?void 0:navigator.language,{style:"decimal",minimumFractionDigits:n,maximumFractionDigits:n})}const Et=new Intl.NumberFormat(navigator==null?void 0:navigator.language,{style:"percent",minimumFractionDigits:0,maximumFractionDigits:2});var Pt=V('<div class="px-1"><!></div>');function kt(n,e){B(e,!0);var r=Pt(),a=o(r);Vt(a,()=>e.children),i(r),w(n,r),K()}var Bt=V('<div class="title fw-bold px-2 py-1 rounded-start svelte-pyu8kv"> </div>');function Ct(n,e){var r=Bt(),a=o(r);i(r),R(()=>U(a,e.title)),w(n,r)}var ot,it,st,lt,ht;class Kt{constructor(){M(this,lt);M(this,ot,I(!1));M(this,it,I(!1));M(this,st,I(!1));window.addEventListener("keydown",e=>gt(this,lt,ht).call(this,e)),window.addEventListener("keyup",e=>gt(this,lt,ht).call(this,e))}get shift(){return c(G(this,ot))}get ctrl(){return c(G(this,it))}get alt(){return c(G(this,st))}}ot=new WeakMap,it=new WeakMap,st=new WeakMap,lt=new WeakSet,ht=function(e){S(G(this,st),h(e.altKey)),S(G(this,it),h(e.ctrlKey)),S(G(this,ot),h(e.shiftKey))};const zt=new Kt;function Mt(n,e,r,a,s){e(e().alignment=r[n.ctrlKey?a():s()],!0)}var Jt=(n,e)=>e(e().pinned=!e().pinned,!0),Qt=V('<div class="d-flex flex-row ps-2"><span class="fw-semibold text-nowrap text-truncate"> </span> <button type="button" class="btn btn-neutral btn-sm ms-auto" title="Click: Next alignment; Ctrl + Click: Previous alignment"><i></i></button> <button class="btn btn-neutral btn-sm"><span><i></i></span></button></div>');const J=["start","center","end"],Ut={center:"text-center",end:"text-right",start:"text-left"};function Tt(n,e){B(e,!0);let r=_t(e,"col",7),a=at(()=>J.findIndex(y=>y===(r().alignment??"start"))),s=at(()=>Ut[J[zt.ctrl?v():l()]]);function l(){return(c(a)+1)%J.length}function v(){return(c(a)-1+J.length)%J.length}var _=Qt(),d=o(_),C=o(d);i(d);var k=t(t(d,!0));k.__click=[Mt,r,J,v,l];var g=o(k);i(k);var b=t(t(k,!0));b.__click=[Jt,r];var u=o(b),p=o(u);i(u),i(b),i(_),R(()=>{U(C,r().text),mt(g,`bi bi-${c(s)??""}`),L(u,"title",`Click to ${(r().pinned?"un":"")??""}pin`),mt(p,`bi bi-pin-${(r().pinned?"fill":"angle")??""}`)}),w(n,_),K()}It(["click"]);var Yt=V('<button type="button" class="btn btn-sm btn-info" title="Click to show additional information" data-bs-toggle="offcanvas"><i class="bi bi-info-circle"></i></button>'),Xt=V('<div class="btn-toolbar my-2 py-1 px-1 gap-2 border border-1 rounded"><!> <div class="input-group input-group-sm"><span class="input-group-text" title="Row Options:"><i class="bi bi-list-check"></i></span> <div class="btn-group btn-group-sm"><input type="checkbox" class="btn-check"> <label class="btn btn-outline-primary rounded-0">Striped</label> <input type="checkbox" class="btn-check"> <label class="btn btn-outline-primary">Row Tracking</label> <input type="checkbox" class="btn-check"> <label class="btn btn-outline-primary">Selection Highlight</label></div></div> <div class="input-group input-group-sm"><span title="Borders:" class="input-group-text"><i class="bi bi-border-all"></i></span> <div class="btn-group btn-group-sm"><input type="checkbox" class="btn-check"> <label class="btn btn-outline-primary rounded-0" title="Row borders"><i class="bi bi-border-bottom"></i></label> <input type="checkbox" class="btn-check"> <label class="btn btn-outline-primary" title="Column borders"><i class="bi bi-border-right"></i></label></div></div> <!></div>');function xt(n,e){B(e,!0);const r=[];let a=_t(e,"options",7),s=I(h([]));const l=$t();Wt(()=>{a(a().gridLines=c(s).reduce((D,O)=>D|O,$.None),!0)});var v=Xt(),_=o(v);rt(_,()=>e.moreInfoTarget,D=>{var O=Yt();o(O),i(O),R(()=>L(O,"data-bs-target",`#${e.moreInfoTarget??""}`)),w(D,O)});var d=t(t(_,!0)),C=o(d);o(C),i(C);var k=t(t(C,!0)),g=o(k);Q(g),L(g,"id",`${l??""}_striped`);var b=t(t(g,!0));L(b,"for",`${l??""}_striped`);var u=t(t(b,!0));Q(u),L(u,"id",`${l??""}_rowTracking`);var p=t(t(u,!0));L(p,"for",`${l??""}_rowTracking`);var y=t(t(p,!0));Q(y),L(y,"id",`${l??""}_rowSelectionHighlight`);var z=t(t(y,!0));L(z,"for",`${l??""}_rowSelectionHighlight`),i(k),i(d);var f=t(t(d,!0)),j=o(f);o(j),i(j);var W=t(t(j,!0)),T=o(W);Q(T),L(T,"id",`${l??""}_rowGridLine`);var E,q=t(t(T,!0));L(q,"for",`${l??""}_rowGridLine`),o(q),i(q);var N=t(t(q,!0));Q(N),L(N,"id",`${l??""}_colGridLine`);var x,m=t(t(N,!0));L(m,"for",`${l??""}_colGridLine`),o(m),i(m),i(W),i(f);var P=t(t(f,!0));Vt(P,()=>e.children),i(v),R(()=>{E!==(E=$.Row)&&(T.value=(T.__value=$.Row)==null?"":$.Row),x!==(x=$.Column)&&(N.value=(N.__value=$.Column)==null?"":$.Column)}),ut(g,()=>a().striping,D=>a(a().striping=D,!0)),ut(u,()=>a().rowTracking,D=>a(a().rowTracking=D,!0)),ut(y,()=>a().rowSelectionHighlight,D=>a(a().rowSelectionHighlight=D,!0)),Ft(r,[],T,()=>c(s),D=>S(s,D)),Ft(r,[],N,()=>c(s),D=>S(s,D)),w(n,v),K()}var Zt=V('<!> <!> <hr class="border-3">',1);function te(n,e){B(e,!0);let r=I(h([{key:"id",text:"ID"},{key:"country_code",text:"Country Code"},{key:"country_name",text:"Country"},{key:"city",text:"City"},{key:"month",text:"Month"},{key:"year",text:"Year"},{key:"sales_amount",text:"Sales Amount",dataType:"real-amount",numberFormatter:X(2),alignment:"end"},{key:"product_category",text:"Product Category",width:12},{key:"quantity_sold",text:"Quantity Sold",dataType:"int-amount",numberFormatter:X(0),alignment:"end"},{key:"total_sales",text:"Total Sales",dataType:"currency",numberFormatter:Y,alignment:"end"},{key:"total_costs",text:"Total Costs",dataType:"currency",numberFormatter:Y,alignment:"end"},{key:"top_client",text:"Top Client"},{key:"top_client_fraction",text:"Top Client Fraction",width:13,dataType:"real-amount",numberFormatter:Et,alignment:"center"}])),a=I(h(yt(e.sourceData.detail.filter(d=>d.country_code===e.countryCode&&d.city===e.city)))),s=I(h({gridLines:$.None,rowSelectionHighlight:!0,rowTracking:!0,striping:!0}));var l=Zt(),v=A(l);xt(v,{get options(){return c(s)},set options(d){S(s,h(d))},moreInfoTarget:"thirdLevelCanvas"});var _=t(t(v,!0));ft(_,{get columns(){return c(r)},set columns(g){S(r,h(g))},get data(){return c(a)},set data(g){S(a,h(g))},get noViewport(){return pt.noViewportInChildren},get rowTracking(){return c(s).rowTracking},get rowSelectionHighlight(){return c(s).rowSelectionHighlight},get striped(){return c(s).striping},get gridLines(){return c(s).gridLines},defaultWidth:12,class:"mb-5",caption:g=>{Ct(g,{get title(){return`Raw Data: ${e.city??""}`}})},headerCell:(g,b=H)=>{Tt(g,{get col(){return b().col},set col(u){b().col=u}})},dataCell:(g,b=H)=>{kt(g,{children:(u,p)=>{var y=dt(),z=A(y);rt(z,()=>b().col.numberFormatter,f=>{var j=at(()=>b().getFn(b().row));wt(f,{get value(){return c(j)},get formatter(){return b().col.numberFormatter}})},f=>{var j=bt();R(()=>U(j,b().getFn(b().row))),w(f,j)}),w(u,y)},$$slots:{default:!0}})}}),t(t(_,!0)),w(n,l),K()}var ee=(n,e)=>e(e().wjdv.expanded=!e().wjdv.expanded,!0),ae=V('<button type="button" class="btn btn-neutral btn-sm"><i></i></button>');function Lt(n,e){B(e,!0);let r=_t(e,"row",7);var a=ae();a.__click=[ee,r];var s=o(a);i(a),R(()=>mt(s,`bi bi-chevron-bar-${(r().wjdv.expanded?"contract":"expand")??""}`)),w(n,a),K()}It(["click"]);var re=V('<!> <!> <hr class="border-3">',1);function ne(n,e){B(e,!0);let r=I(h([{key:"city",text:"City",dataType:"string"},{key:"sales_amount",text:"Total Amount",alignment:"end",dataType:"real-amount",numberFormatter:X(2)},{key:"quantity_sold",text:"Total Quantity",alignment:"end",dataType:"int-amount",numberFormatter:X(0)},{key:"total_sales",text:"Total Sales",alignment:"end",dataType:"currency",numberFormatter:Y},{key:"total_costs",text:"Total Costs",alignment:"end",dataType:"currency",numberFormatter:Y}])),a=I(h(yt(e.sourceData.byCity.filter(d=>d.country_code===e.countryCode),d=>`${d.country_code}_${d.city}`))),s=I(h({gridLines:$.None,rowSelectionHighlight:!0,rowTracking:!0,striping:!0}));var l=re(),v=A(l);xt(v,{get options(){return c(s)},set options(d){S(s,h(d))},moreInfoTarget:"secondLevelCanvas"});var _=t(t(v,!0));ft(_,{get columns(){return c(r)},set columns(u){S(r,h(u))},get data(){return c(a)},set data(u){S(a,h(u))},get noViewport(){return pt.noViewportInChildren},get rowTracking(){return c(s).rowTracking},get rowSelectionHighlight(){return c(s).rowSelectionHighlight},get striped(){return c(s).striping},get gridLines(){return c(s).gridLines},defaultWidth:12,controlColumn:{width:3,alignment:"center"},class:"mb-5",style:"z-index: 5",caption:u=>{Ct(u,{get title(){return`Per-City Summary: ${e.countryName??""}`}})},headerCell:(u,p=H)=>{Tt(u,{get col(){return p().col},set col(y){p().col=y}})},dataCell:(u,p=H)=>{kt(u,{children:(y,z)=>{var f=dt(),j=A(f);rt(j,()=>p().col.dataType!=="string",W=>{var T=at(()=>p().getFn(p().row));wt(W,{get value(){return c(T)},get formatter(){return p().col.numberFormatter}})},W=>{var T=bt();R(()=>U(T,p().getFn(p().row))),w(W,T)}),w(y,f)},$$slots:{default:!0}})},controlDataCell:(u,p=H)=>{Lt(u,{get row(){return p().row},set row(y){p().row=y}})},rowExpansion:(u,p=H)=>{te(u,{get sourceData(){return e.sourceData},get countryCode(){return e.countryCode},get city(){return p().row.city}})}}),t(t(_,!0)),w(n,l),K()}function oe(){const n={};return n.gridLines=$.None,n.rowSelectionHighlight=!0,n.rowTracking=!0,n.striping=!0,n}var ie=V(`<div class="offcanvas offcanvas-end bg-info bg-glass svelte-1i880sp" id="firstLevelCanvas" data-bs-backdrop="false"><div class="offcanvas-header"><h3 class="offcanvas-title">Worldwide Sales Rollup Demo</h3></div> <div class="offcanvas-body"><p>This table shows the rolled-up summary of (ficticious) sales data.  The record feed is random and courtesy 
            of <a href="https://www.mockaroo.com" target="_blank">Mockaroo</a>.  The original records can be seen at 
            the third level.</p> <p>The toolbar above the table can be used to turn <span class="code svelte-1i880sp">WjDataView</span>'s features on and 
            off.  As data is drilled down, more toolbars will appear for the additional <span class="code svelte-1i880sp">WjDataView</span> components that show the more detailed data.</p> <h4>Drilldown Features</h4> <p>Currently there is one significant feature that effects how users experience data drilldown using <span class="code svelte-1i880sp">WjDataView</span>:  The <span class="code svelte-1i880sp">noViewport</span> property.</p> <p>Instances of <span class="code svelte-1i880sp">WjDataView</span> provide their own viewport.  The viewport is the 
            container in charge of providing horizontal and vertical scrollbars to the component so all data can be 
            examined.  Furthermore, the header row is configured to be sticky.  This means that the header row will 
            "stick" to the viewport when said viewport is scrolled vertically.</p> <p>But what happens when the viewport disappears?  The header row will now stick to the next available 
            viewport, and that's the viewport of the parent <span class="code svelte-1i880sp">WjDataView</span> component.  The net 
            result is that the header row of child <span class="code svelte-1i880sp">WjDataView</span> components are now in the 
            position of overlapping the parent's header row.</p> <h5>How To Experience the effect of <span class="code svelte-1i880sp">noViewport</span>?</h5> <p>Simply expand a row or rows until the vertical scrollbar has enough room to make the the header row of a 
            child <span class="code svelte-1i880sp">WjDataView</span> component reach the top of the parent's viewport.</p> <p>In order to experience the difference, the "no viewport" setting can be turned off by using the top 
            toolbar.  The option is the button with the <i class="bi bi-eye-slash"></i> icon.</p></div></div>`);function se(n){var e=ie(),r=o(e);o(r),i(r);var a=t(t(r,!0)),s=o(a);t(o(s)),F(),i(s);var l=t(t(s,!0)),v=t(o(l));t(t(v,!0)),F(),i(l);var _=t(t(l,!0)),d=t(t(_,!0)),C=t(o(d));t(t(C,!0)),F(),i(d);var k=t(t(d,!0));t(o(k)),F(),i(k);var g=t(t(k,!0)),b=t(o(g));t(t(b,!0)),F(),i(g);var u=t(t(g,!0));t(o(u)),F(),i(u);var p=t(t(u,!0));t(o(p)),F(),i(p);var y=t(t(p,!0));t(o(y)),F(),i(y),i(a),i(e),w(n,e)}var le=V(`<div class="offcanvas offcanvas-end bg-info bg-glass svelte-1i880sp" id="secondLevelCanvas" data-bs-backdrop="false"><div class="offcanvas-header"><h3 class="offcanvas-title">Worldwide Sales Rollup Demo</h3></div> <div class="offcanvas-body"><p>This is a second-level <span class="code svelte-1i880sp">WjDataView</span> component.  It shows the same information as 
            the first level, but rolled up to city, not country.</p> <p>Feel free to scroll up and down and turn table features on and off.  Do you have an idea or suggestion to 
            make things better?  Stop by the <a href="https://github.com/WJSoftware/wjfe-dataview/issues" target="_blank">project's issues page</a> and open a new issue.</p></div></div>`);function ce(n){var e=le(),r=o(e);o(r),i(r);var a=t(t(r,!0)),s=o(a);t(o(s)),F(),i(s);var l=t(t(s,!0));t(o(l)),F(),i(l),i(a),i(e),w(n,e)}var ue=V(`<div class="offcanvas offcanvas-end bg-info bg-glass svelte-1i880sp" id="thirdLevelCanvas" data-bs-backdrop="false"><div class="offcanvas-header"><h3 class="offcanvas-title">Worldwide Sales Rollup Demo</h3></div> <div class="offcanvas-body"><p>This is the third and last level of data.  It shows the raw records obtained from the mocking service, <a href="https://www.mockaroo.com" target="_blank">Mockaroo</a>.</p> <p>This demo queries for this raw data in Sveltekit's <span class="code svelte-1i880sp">+page.ts</span> code file, and then 
            calculates the rollups.</p> <p>Would you like to experiment a bit?  Simply for the project, then run <span class="code svelte-1i880sp">npm ci</span>, 
            and then run <span class="code svelte-1i880sp">npm run dev</span>.  The sales demo page is at <span class="code svelte-1i880sp">/routes/sales</span>.  For example, you could try rolling the data up differently, say, 
            by customer or by product category.  You could also create an alternative data feed, either from real data 
            or faked data.</p> <p class="display-6 text-center mt-5">Don't forget to give the project a star on <a href="https://github.com/WJSoftware/wjfe-dataview" target="_blank">GitHub&nbsp;<i class="bi bi-github"></i></a>!</p></div></div>`);function de(n){var e=ue(),r=o(e);o(r),i(r);var a=t(t(r,!0)),s=o(a);t(o(s)),F(),i(s);var l=t(t(s,!0));t(o(l)),F(),i(l);var v=t(t(l,!0)),_=t(o(v)),d=t(t(_,!0));t(t(d,!0)),F(),i(v);var C=t(t(v,!0)),k=t(o(C));t(o(k)),i(k),F(),i(C),i(a),i(e),w(n,e)}var pe=V('<div class="input-group input-group-sm"><span class="input-group-text" title="Drilldown:"><i class="bi bi-bar-chart-steps"></i></span> <input type="checkbox" id="noViewportInChildren" class="btn-check"> <label for="noViewportInChildren" class="btn btn-outline-primary btn-sm" title="No viewports in children"><i class="bi bi-eye-slash"></i></label></div>'),ve=V(`<img alt="Country's flag"> `,1),ge=V('<hgroup class="mb-3"><h1>WjDataView Demo</h1> <h4>Worldwide Sales Data Rollup</h4></hgroup> <div class="d-flex flex-column flex-fill"><!> <div class="flex-fill position-relative"><!> <!></div></div> <!> <!> <!>',1);function Ce(n,e){B(e,!0);let r=I(h(oe())),a=I(h([{key:"country",text:"Country",get:l},{key:"sales_amount",text:"Total Amount",alignment:"end",dataType:"real-amount",numberFormatter:X(2)},{key:"quantity_sold",text:"Total Quantity",alignment:"end",dataType:"int-amount",numberFormatter:X(0)},{key:"total_sales",text:"Total Sales",alignment:"end",dataType:"currency",numberFormatter:Y},{key:"total_costs",text:"Total Costs",alignment:"end",dataType:"currency",numberFormatter:Y}])),s=I(h(yt(e.data.byCountry,f=>f.country_code)));function l(f){return`${f.country_name} (${f.country_code})`}var v=ge(),_=A(v),d=o(_);t(t(d,!0)),i(_);var C=t(t(_,!0)),k=o(C);xt(k,{get options(){return c(r)},set options(f){S(r,h(f))},moreInfoTarget:"firstLevelCanvas",children:(f,j)=>{var W=pe(),T=o(W);o(T),i(T);var E=t(t(T,!0));Q(E);var q=t(t(E,!0));o(q),i(q),i(W),ut(E,()=>pt.noViewportInChildren,N=>pt.noViewportInChildren=N),w(f,W)},$$slots:{default:!0}});var g=t(t(k,!0)),b=o(g);Ht(b,{get theme(){return Nt.currentTheme},children:(f,j)=>{ft(f,{get columns(){return c(a)},set columns(x){S(a,h(x))},get data(){return c(s)},set data(x){S(s,h(x))},get striped(){return c(r).striping},get rowTracking(){return c(r).rowTracking},get rowSelectionHighlight(){return c(r).rowSelectionHighlight},get gridLines(){return c(r).gridLines},defaultWidth:15,class:"position-absolute top-0 bottom-0",controlColumn:{width:3,alignment:"center"},style:"z-index: 5",caption:x=>{Ct(x,{title:"Global Overview"})},controlDataCell:(x,m=H)=>{Lt(x,{get row(){return m().row},set row(P){m().row=P}})},rowExpansion:(x,m=H)=>{ne(x,{get sourceData(){return e.data},get countryCode(){return m().row.country_code},get countryName(){return m().row.country_name}})},headerCell:(x,m=H)=>{Tt(x,{get col(){return m().col},set col(P){m().col=P}})},dataCell:(x,m=H)=>{kt(x,{children:(P,D)=>{var O=dt(),jt=A(O);rt(jt,()=>m().col.key==="country",vt=>{var Z=ve(),tt=A(Z),et=t(tt,!0);R(()=>U(et,` ${m().getFn(m().row)??""}`)),R(()=>{L(tt,"src",`https://countryflagsapi.netlify.app/flag/${m().row.country_code??""}.svg`),Ot(tt,"height","1em")}),w(vt,Z)},vt=>{var Z=dt(),tt=A(Z);rt(tt,()=>m().col.dataType!=="string",et=>{var ct=at(()=>m().getFn(m().row));wt(et,{get value(){return c(ct)},get formatter(){return m().col.numberFormatter}})},et=>{var ct=bt();R(()=>U(ct,m().getFn(m().row))),w(et,ct)},!0),w(vt,Z)}),w(P,O)},$$slots:{default:!0}})}})},$$slots:{default:!0}});var u=t(t(b,!0));Rt(u,{editUrl:"https://github.com/WJSoftware/wjfe-dataview/blob/main/src/routes/sales/%2Bpage.svelte"}),i(g),i(C);var p=t(t(C,!0));se(p);var y=t(t(p,!0));ce(y);var z=t(t(y,!0));de(z),w(n,v),K()}export{Ce as component,ke as universal};
