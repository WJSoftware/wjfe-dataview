var xt=n=>{throw TypeError(n)};var St=(n,e,r)=>e.has(n)||xt("Cannot "+r);var O=(n,e,r)=>(St(n,e,"read from private field"),r?r.call(n):e.get(n)),M=(n,e,r)=>e.has(n)?xt("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,r);var gt=(n,e,r)=>(St(n,e,"access private method"),r);import{c as o,r as i,a as w,t as L,n as Ft,s as t,b as U,f as A,w as ut,p as bt,o as D}from"../chunks/disclose-version.CqyMsf3s.js";import{z as F,g as c,B as S,p as B,f as K,t as G,I as et,u as Lt,n as N}from"../chunks/runtime.DkqSkKrO.js";import{i as at}from"../chunks/this.DlH2oH7g.js";import{b as It,s as mt,a as V,r as Q}from"../chunks/index.DaRDEEDh.js";import{b as ct,a as Dt,G as R,d as yt,f as ft,N as _t,W as jt,E as Wt,t as $t,s as Ht}from"../chunks/themeOptions.svelte.pDPLAlrY.js";import{a as b,p as wt}from"../chunks/props.DlkvsI11.js";const Rt=async({fetch:n})=>{const a=await(await n("https://my.api.mockaroo.com/geosales.json?key=a53dac10")).json();return Nt(a)};function Nt(n){const e={},r=[];for(let a of n){const s=e[a.country_code]=e[a.country_code]??{country_name:a.country_name,country_code:a.country_code,quantity_sold:0,sales_amount:0,total_costs:0,total_sales:0};s.quantity_sold+=a.quantity_sold,s.sales_amount+=a.sales_amount,s.total_costs+=a.total_costs,s.total_sales+=a.total_sales;let l=r.find(g=>g.country_code===a.country_code&&g.city===a.city);l||(l={country_code:a.country_code,country_name:a.country_name,city:a.city,quantity_sold:0,sales_amount:0,total_costs:0,total_sales:0},r.push(l)),l.quantity_sold+=a.quantity_sold,l.sales_amount+=a.sales_amount,l.total_costs+=a.total_costs,l.total_sales+=a.total_sales}return{detail:n,byCity:r,byCountry:Object.keys(e).map(a=>e[a])}}const _e=Object.freeze(Object.defineProperty({__proto__:null,load:Rt},Symbol.toStringTag,{value:"Module"}));var rt;class Ot{constructor(){M(this,rt,F(!0))}get noViewportInChildren(){return c(O(this,rt))}set noViewportInChildren(e){S(O(this,rt),b(e))}}rt=new WeakMap;const dt=new Ot,Y=new Intl.NumberFormat(navigator==null?void 0:navigator.language,{style:"currency",currency:"USD",currencyDisplay:"narrowSymbol"});function X(n){return new Intl.NumberFormat(navigator==null?void 0:navigator.language,{style:"decimal",minimumFractionDigits:n,maximumFractionDigits:n})}const Gt=new Intl.NumberFormat(navigator==null?void 0:navigator.language,{style:"percent",minimumFractionDigits:0,maximumFractionDigits:2});var qt=L('<div class="px-1"><!></div>');function kt(n,e){B(e,!0);var r=qt(),a=o(r);It(a,()=>e.children),i(r),w(n,r),K()}var nt,ot,it,st,ht;class At{constructor(){M(this,st);M(this,nt,F(!1));M(this,ot,F(!1));M(this,it,F(!1));window.addEventListener("keydown",e=>gt(this,st,ht).call(this,e)),window.addEventListener("keyup",e=>gt(this,st,ht).call(this,e))}get shift(){return c(O(this,nt))}get ctrl(){return c(O(this,ot))}get alt(){return c(O(this,it))}}nt=new WeakMap,ot=new WeakMap,it=new WeakMap,st=new WeakSet,ht=function(e){S(O(this,it),b(e.altKey)),S(O(this,ot),b(e.ctrlKey)),S(O(this,nt),b(e.shiftKey))};const Et=new At;function Pt(n,e,r,a,s){e(e().alignment=r[n.ctrlKey?a():s()],!0)}var Bt=(n,e)=>e(e().pinned=!e().pinned,!0),Kt=L('<div class="d-flex flex-row ps-2"><span class="fw-semibold text-nowrap text-truncate"> </span> <button type="button" class="btn btn-neutral btn-sm ms-auto" title="Click: Next alignment; Ctrl + Click: Previous alignment"><i></i></button> <button class="btn btn-neutral btn-sm"><span><i></i></span></button></div>');const J=["start","center","end"],zt={center:"text-center",end:"text-right",start:"text-left"};function Ct(n,e){B(e,!0);let r=wt(e,"col",7),a=et(()=>J.findIndex(x=>x===(r().alignment??"start"))),s=et(()=>zt[J[Et.ctrl?g():l()]]);function l(){return(c(a)+1)%J.length}function g(){return(c(a)-1+J.length)%J.length}var f=Kt(),d=o(f),T=o(d);i(d);var p=t(t(d,!0));p.__click=[Pt,r,J,g,l];var h=o(p);i(p);var v=t(t(p,!0));v.__click=[Bt,r];var u=o(v),_=o(u);i(u),i(v),i(f),G(()=>{U(T,r().text),mt(h,`bi bi-${c(s)??""}`),V(u,"title",`Click to ${(r().pinned?"un":"")??""}pin`),mt(_,`bi bi-pin-${(r().pinned?"fill":"angle")??""}`)}),w(n,f),K()}Ft(["click"]);let Mt=0;function Jt(n){return`control${++Mt}`}var Qt=L('<button type="button" class="btn btn-sm btn-info" title="Click to show additional information" data-bs-toggle="offcanvas"><i class="bi bi-info-circle"></i></button>'),Ut=L('<div class="btn-toolbar my-2 py-1 px-1 gap-2 border border-1 rounded"><span class="toolbar-name fw-bold px-2 py-1 rounded-start svelte-1umxg75"> </span> <!> <div class="input-group input-group-sm"><span class="input-group-text" title="Row Options:"><i class="bi bi-list-check"></i></span> <div class="btn-group btn-group-sm"><input type="checkbox" class="btn-check"> <label class="btn btn-outline-primary rounded-0">Striped</label> <input type="checkbox" class="btn-check"> <label class="btn btn-outline-primary">Row Tracking</label> <input type="checkbox" class="btn-check"> <label class="btn btn-outline-primary">Selection Highlight</label></div></div> <div class="input-group input-group-sm"><span title="Borders:" class="input-group-text"><i class="bi bi-border-all"></i></span> <div class="btn-group btn-group-sm"><input type="checkbox" class="btn-check"> <label class="btn btn-outline-primary rounded-0" title="Row borders"><i class="bi bi-border-bottom"></i></label> <input type="checkbox" class="btn-check"> <label class="btn btn-outline-primary" title="Column borders"><i class="bi bi-border-right"></i></label></div></div> <!></div>');function Tt(n,e){B(e,!0);const r=[];let a=wt(e,"options",7),s=F(b([]));const l=Jt();Lt(()=>{a(a().gridLines=c(s).reduce((k,W)=>k|W,R.None),!0)});var g=Ut(),f=o(g),d=o(f);i(f);var T=t(t(f,!0));at(T,()=>e.moreInfoTarget,k=>{var W=Qt();o(W),i(W),G(()=>V(W,"data-bs-target",`#${e.moreInfoTarget??""}`)),w(k,W)});var p=t(t(T,!0)),h=o(p);o(h),i(h);var v=t(t(h,!0)),u=o(v);Q(u),V(u,"id",`${l??""}_striped`);var _=t(t(u,!0));V(_,"for",`${l??""}_striped`);var x=t(t(_,!0));Q(x),V(x,"id",`${l??""}_rowTracking`);var $=t(t(x,!0));V($,"for",`${l??""}_rowTracking`);var y=t(t($,!0));Q(y),V(y,"id",`${l??""}_rowSelectionHighlight`);var E=t(t(y,!0));V(E,"for",`${l??""}_rowSelectionHighlight`),i(v),i(p);var I=t(t(p,!0)),q=o(I);o(q),i(q);var P=t(t(q,!0)),H=o(P);Q(H),V(H,"id",`${l??""}_rowGridLine`);var C,m=t(t(H,!0));V(m,"for",`${l??""}_rowGridLine`),o(m),i(m);var j=t(t(m,!0));Q(j),V(j,"id",`${l??""}_colGridLine`);var pt,z=t(t(j,!0));V(z,"for",`${l??""}_colGridLine`),o(z),i(z),i(P),i(I);var vt=t(t(I,!0));It(vt,()=>e.children),i(g),G(()=>{U(d,e.title),C!==(C=R.Row)&&(H.value=(H.__value=R.Row)==null?"":R.Row),pt!==(pt=R.Column)&&(j.value=(j.__value=R.Column)==null?"":R.Column)}),ct(u,()=>a().striping,k=>a(a().striping=k,!0)),ct(x,()=>a().rowTracking,k=>a(a().rowTracking=k,!0)),ct(y,()=>a().rowSelectionHighlight,k=>a(a().rowSelectionHighlight=k,!0)),Dt(r,[],H,()=>c(s),k=>S(s,k)),Dt(r,[],j,()=>c(s),k=>S(s,k)),w(n,g),K()}var Yt=L('<!> <!> <hr class="border-3">',1);function Xt(n,e){B(e,!0);let r=F(b([{key:"id",text:"ID"},{key:"country_code",text:"Country Code"},{key:"country_name",text:"Country"},{key:"city",text:"City"},{key:"month",text:"Month"},{key:"year",text:"Year"},{key:"sales_amount",text:"Sales Amount",dataType:"real-amount",numberFormatter:X(2),alignment:"end"},{key:"product_category",text:"Product Category",width:12},{key:"quantity_sold",text:"Quantity Sold",dataType:"int-amount",numberFormatter:X(0),alignment:"end"},{key:"total_sales",text:"Total Sales",dataType:"currency",numberFormatter:Y,alignment:"end"},{key:"total_costs",text:"Total Costs",dataType:"currency",numberFormatter:Y,alignment:"end"},{key:"top_client",text:"Top Client"},{key:"top_client_fraction",text:"Top Client Fraction",width:13,dataType:"real-amount",numberFormatter:Gt,alignment:"center"}])),a=F(b(yt(e.sourceData.detail.filter(d=>d.country_code===e.countryCode&&d.city===e.city)))),s=F(b({gridLines:R.None,rowSelectionHighlight:!0,rowTracking:!0,striping:!0}));var l=Yt(),g=A(l);Tt(g,{get title(){return`Raw Data: ${e.city??""}`},get options(){return c(s)},set options(d){S(s,b(d))},moreInfoTarget:"thirdLevelCanvas"});var f=t(t(g,!0));ft(f,{get columns(){return c(r)},set columns(p){S(r,b(p))},get data(){return c(a)},set data(p){S(a,b(p))},get noViewport(){return dt.noViewportInChildren},get rowTracking(){return c(s).rowTracking},get rowSelectionHighlight(){return c(s).rowSelectionHighlight},get striped(){return c(s).striping},get gridLines(){return c(s).gridLines},defaultWidth:12,class:"mb-5",headerCell:(p,h=N)=>{Ct(p,{get col(){return h().col},set col(v){h().col=v}})},dataCell:(p,h=N)=>{kt(p,{children:(v,u)=>{var _=ut(),x=A(_);at(x,()=>h().col.numberFormatter,$=>{var y=et(()=>h().getFn(h().row));_t($,{get value(){return c(y)},get formatter(){return h().col.numberFormatter}})},$=>{var y=bt();G(()=>U(y,h().getFn(h().row))),w($,y)}),w(v,_)},$$slots:{default:!0}})}}),t(t(f,!0)),w(n,l),K()}var Zt=(n,e)=>e(e().wjdv.expanded=!e().wjdv.expanded,!0),te=L('<button type="button" class="btn btn-neutral btn-sm"><i></i></button>');function Vt(n,e){B(e,!0);let r=wt(e,"row",7);var a=te();a.__click=[Zt,r];var s=o(a);i(a),G(()=>mt(s,`bi bi-chevron-bar-${(r().wjdv.expanded?"contract":"expand")??""}`)),w(n,a),K()}Ft(["click"]);var ee=L('<!> <!> <hr class="border-3">',1);function ae(n,e){B(e,!0);let r=F(b([{key:"city",text:"City",dataType:"string"},{key:"sales_amount",text:"Total Amount",alignment:"end",dataType:"real-amount",numberFormatter:X(2)},{key:"quantity_sold",text:"Total Quantity",alignment:"end",dataType:"int-amount",numberFormatter:X(0)},{key:"total_sales",text:"Total Sales",alignment:"end",dataType:"currency",numberFormatter:Y},{key:"total_costs",text:"Total Costs",alignment:"end",dataType:"currency",numberFormatter:Y}])),a=F(b(yt(e.sourceData.byCity.filter(d=>d.country_code===e.countryCode),d=>`${d.country_code}_${d.city}`))),s=F(b({gridLines:R.None,rowSelectionHighlight:!0,rowTracking:!0,striping:!0}));var l=ee(),g=A(l);Tt(g,{get title(){return`Per-City Summary: ${e.countryName??""}`},get options(){return c(s)},set options(d){S(s,b(d))},moreInfoTarget:"secondLevelCanvas"});var f=t(t(g,!0));ft(f,{get columns(){return c(r)},set columns(v){S(r,b(v))},get data(){return c(a)},set data(v){S(a,b(v))},get noViewport(){return dt.noViewportInChildren},get rowTracking(){return c(s).rowTracking},get rowSelectionHighlight(){return c(s).rowSelectionHighlight},get striped(){return c(s).striping},get gridLines(){return c(s).gridLines},defaultWidth:12,controlColumn:{width:3,alignment:"center"},class:"mb-5",style:"z-index: 5",headerCell:(v,u=N)=>{Ct(v,{get col(){return u().col},set col(_){u().col=_}})},dataCell:(v,u=N)=>{kt(v,{children:(_,x)=>{var $=ut(),y=A($);at(y,()=>u().col.dataType!=="string",E=>{var I=et(()=>u().getFn(u().row));_t(E,{get value(){return c(I)},get formatter(){return u().col.numberFormatter}})},E=>{var I=bt();G(()=>U(I,u().getFn(u().row))),w(E,I)}),w(_,$)},$$slots:{default:!0}})},controlDataCell:(v,u=N)=>{Vt(v,{get row(){return u().row},set row(_){u().row=_}})},rowExpansion:(v,u=N)=>{Xt(v,{get sourceData(){return e.sourceData},get countryCode(){return e.countryCode},get city(){return u().row.city}})}}),t(t(f,!0)),w(n,l),K()}function re(){const n={};return n.gridLines=R.None,n.rowSelectionHighlight=!0,n.rowTracking=!0,n.striping=!0,n}var ne=L(`<div class="offcanvas offcanvas-end bg-info bg-glass svelte-1i880sp" id="firstLevelCanvas" data-bs-backdrop="false"><div class="offcanvas-header"><h3 class="offcanvas-title">Worldwide Sales Rollup Demo</h3></div> <div class="offcanvas-body"><p>This table shows the rolled-up summary of (ficticious) sales data.  The record feed is random and courtesy 
            of <a href="https://www.mockaroo.com" target="_blank">Mockaroo</a>.  The original records can be seen at 
            the third level.</p> <p>The toolbar above the table can be used to turn <span class="code svelte-1i880sp">WjDataView</span>'s features on and 
            off.  As data is drilled down, more toolbars will appear for the additional <span class="code svelte-1i880sp">WjDataView</span> components that show the more detailed data.</p> <h4>Drilldown Features</h4> <p>Currently there is one significant feature that effects how users experience data drilldown using <span class="code svelte-1i880sp">WjDataView</span>:  The <span class="code svelte-1i880sp">noViewport</span> property.</p> <p>Instances of <span class="code svelte-1i880sp">WjDataView</span> provide their own viewport.  The viewport is the 
            container in charge of providing horizontal and vertical scrollbars to the component so all data can be 
            examined.  Furthermore, the header row is configured to be sticky.  This means that the header row will 
            "stick" to the viewport when said viewport is scrolled vertically.</p> <p>But what happens when the viewport disappears?  The header row will now stick to the next available 
            viewport, and that's the viewport of the parent <span class="code svelte-1i880sp">WjDataView</span> component.  The net 
            result is that the header row of child <span class="code svelte-1i880sp">WjDataView</span> components are now in the 
            position of overlapping the parent's header row.</p> <h5>How To Experience the effect of <span class="code svelte-1i880sp">noViewport</span>?</h5> <p>Simply expand a row or rows until the vertical scrollbar has enough room to make the the header row of a 
            child <span class="code svelte-1i880sp">WjDataView</span> component reach the top of the parent's viewport.</p> <p>In order to experience the difference, the "no viewport" setting can be turned off by using the top 
            toolbar.  The option is the button with the <i class="bi bi-eye-slash"></i> icon.</p></div></div>`);function oe(n){var e=ne(),r=o(e);o(r),i(r);var a=t(t(r,!0)),s=o(a);t(o(s)),D(),i(s);var l=t(t(s,!0)),g=t(o(l));t(t(g,!0)),D(),i(l);var f=t(t(l,!0)),d=t(t(f,!0)),T=t(o(d));t(t(T,!0)),D(),i(d);var p=t(t(d,!0));t(o(p)),D(),i(p);var h=t(t(p,!0)),v=t(o(h));t(t(v,!0)),D(),i(h);var u=t(t(h,!0));t(o(u)),D(),i(u);var _=t(t(u,!0));t(o(_)),D(),i(_);var x=t(t(_,!0));t(o(x)),D(),i(x),i(a),i(e),w(n,e)}var ie=L(`<div class="offcanvas offcanvas-end bg-info bg-glass svelte-1i880sp" id="secondLevelCanvas" data-bs-backdrop="false"><div class="offcanvas-header"><h3 class="offcanvas-title">Worldwide Sales Rollup Demo</h3></div> <div class="offcanvas-body"><p>This is a second-level <span class="code svelte-1i880sp">WjDataView</span> component.  It shows the same information as 
            the first level, but rolled up to city, not country.</p> <p>Feel free to scroll up and down and turn table features on and off.  Do you have an idea or suggestion to 
            make things better?  Stop by the <a href="https://github.com/WJSoftware/wjfe-dataview/issues" target="_blank">project's issues page</a> and open a new issue.</p></div></div>`);function se(n){var e=ie(),r=o(e);o(r),i(r);var a=t(t(r,!0)),s=o(a);t(o(s)),D(),i(s);var l=t(t(s,!0));t(o(l)),D(),i(l),i(a),i(e),w(n,e)}var le=L(`<div class="offcanvas offcanvas-end bg-info bg-glass svelte-1i880sp" id="thirdLevelCanvas" data-bs-backdrop="false"><div class="offcanvas-header"><h3 class="offcanvas-title">Worldwide Sales Rollup Demo</h3></div> <div class="offcanvas-body"><p>This is the third and last level of data.  It shows the raw records obtained from the mocking service, <a href="https://www.mockaroo.com" target="_blank">Mockaroo</a>.</p> <p>This demo queries for this raw data in Sveltekit's <span class="code svelte-1i880sp">+page.ts</span> code file, and then 
            calculates the rollups.</p> <p>Would you like to experiment a bit?  Simply for the project, then run <span class="code svelte-1i880sp">npm ci</span>, 
            and then run <span class="code svelte-1i880sp">npm run dev</span>.  The sales demo page is at <span class="code svelte-1i880sp">/routes/sales</span>.  For example, you could try rolling the data up differently, say, 
            by customer or by product category.  You could also create an alternative data feed, either from real data 
            or faked data.</p> <p class="display-6 text-center mt-5">Don't forget to give the project a star on <a href="https://github.com/WJSoftware/wjfe-dataview" target="_blank">GitHub&nbsp;<i class="bi bi-github"></i></a>!</p></div></div>`);function ce(n){var e=le(),r=o(e);o(r),i(r);var a=t(t(r,!0)),s=o(a);t(o(s)),D(),i(s);var l=t(t(s,!0));t(o(l)),D(),i(l);var g=t(t(l,!0)),f=t(o(g)),d=t(t(f,!0));t(t(d,!0)),D(),i(g);var T=t(t(g,!0)),p=t(o(T));t(o(p)),i(p),D(),i(T),i(a),i(e),w(n,e)}var ue=L('<div class="input-group input-group-sm"><span class="input-group-text" title="Drilldown:"><i class="bi bi-bar-chart-steps"></i></span> <input type="checkbox" id="noViewportInChildren" class="btn-check"> <label for="noViewportInChildren" class="btn btn-outline-primary btn-sm" title="No viewports in children"><i class="bi bi-eye-slash"></i></label></div>'),de=L(`<img alt="Country's flag"> `,1),pe=L('<hgroup class="mb-3"><h1>WjDataView Demo</h1> <h4>Worldwide Sales Data Rollup</h4></hgroup> <div class="d-flex flex-column flex-fill"><!> <div class="flex-fill position-relative"><!> <!></div></div> <!> <!> <!>',1);function we(n,e){B(e,!0);let r=F(b(re())),a=F(b([{key:"country",text:"Country",get:l},{key:"sales_amount",text:"Total Amount",alignment:"end",dataType:"real-amount",numberFormatter:X(2)},{key:"quantity_sold",text:"Total Quantity",alignment:"end",dataType:"int-amount",numberFormatter:X(0)},{key:"total_sales",text:"Total Sales",alignment:"end",dataType:"currency",numberFormatter:Y},{key:"total_costs",text:"Total Costs",alignment:"end",dataType:"currency",numberFormatter:Y}])),s=F(b(yt(e.data.byCountry,y=>y.country_code)));function l(y){return`${y.country_name} (${y.country_code})`}var g=pe(),f=A(g),d=o(f);t(t(d,!0)),i(f);var T=t(t(f,!0)),p=o(T);Tt(p,{get options(){return c(r)},set options(y){S(r,b(y))},title:"Global Overview",moreInfoTarget:"firstLevelCanvas",children:(y,E)=>{var I=ue(),q=o(I);o(q),i(q);var P=t(t(q,!0));Q(P);var H=t(t(P,!0));o(H),i(H),i(I),ct(P,()=>dt.noViewportInChildren,C=>dt.noViewportInChildren=C),w(y,I)},$$slots:{default:!0}});var h=t(t(p,!0)),v=o(h);jt(v,{get theme(){return $t.currentTheme},children:(y,E)=>{ft(y,{get columns(){return c(a)},set columns(C){S(a,b(C))},get data(){return c(s)},set data(C){S(s,b(C))},get striped(){return c(r).striping},get rowTracking(){return c(r).rowTracking},get rowSelectionHighlight(){return c(r).rowSelectionHighlight},get gridLines(){return c(r).gridLines},defaultWidth:15,class:"position-absolute top-0 bottom-0",controlColumn:{width:3,alignment:"center"},style:"z-index: 5",controlDataCell:(C,m=N)=>{Vt(C,{get row(){return m().row},set row(j){m().row=j}})},rowExpansion:(C,m=N)=>{ae(C,{get sourceData(){return e.data},get countryCode(){return m().row.country_code},get countryName(){return m().row.country_name}})},headerCell:(C,m=N)=>{Ct(C,{get col(){return m().col},set col(j){m().col=j}})},dataCell:(C,m=N)=>{kt(C,{children:(j,pt)=>{var z=ut(),vt=A(z);at(vt,()=>m().col.key==="country",k=>{var W=de(),Z=A(W),tt=t(Z,!0);G(()=>U(tt,` ${m().getFn(m().row)??""}`)),G(()=>{V(Z,"src",`https://countryflagsapi.netlify.app/flag/${m().row.country_code??""}.svg`),Ht(Z,"height","1em")}),w(k,W)},k=>{var W=ut(),Z=A(W);at(Z,()=>m().col.dataType!=="string",tt=>{var lt=et(()=>m().getFn(m().row));_t(tt,{get value(){return c(lt)},get formatter(){return m().col.numberFormatter}})},tt=>{var lt=bt();G(()=>U(lt,m().getFn(m().row))),w(tt,lt)},!0),w(k,W)}),w(j,z)},$$slots:{default:!0}})}})},$$slots:{default:!0}});var u=t(t(v,!0));Wt(u,{editUrl:"https://github.com/WJSoftware/wjfe-dataview/blob/main/src/routes/sales/%2Bpage.svelte"}),i(h),i(T);var _=t(t(T,!0));oe(_);var x=t(t(_,!0));se(x);var $=t(t(x,!0));ce($),w(n,g),K()}export{we as component,_e as universal};
