var mt=a=>{throw TypeError(a)};var kt=(a,t,n)=>t.has(a)||mt("Cannot "+n);var et=(a,t,n)=>(kt(a,t,"read from private field"),n?n.call(a):t.get(a)),vt=(a,t,n)=>t.has(a)?mt("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(a):t.set(a,n);import{a as m,t as k,b as Q,e as X,f as nt,g as Ft}from"../chunks/disclose-version.Cqgx9op9.js";import{aa as x,g as o,N as f,p as E,m as j,o as I,j as z,t as $,b as Tt,k as u,n as T,i as W,ap as bt,h as ot}from"../chunks/runtime.vz7-y3A5.js";import{i as U}from"../chunks/this.CxaN1wJ-.js";import{b as yt,a as C,n as xt,r as J,s as Dt}from"../chunks/index.B3ICpLNZ.js";import{b as at,a as ht,G as H,d as rt,f as it,H as st,A as lt,N as ct,W as St,E as Ht,t as jt,s as It}from"../chunks/themeOptions.svelte.CG877jvX.js";import{a as d,p as ft}from"../chunks/props.BTK8CgjX.js";import"../chunks/legacy.BI9og1Le.js";const Vt=async({fetch:a})=>{const e=await(await a("https://my.api.mockaroo.com/geosales.json?key=a53dac10")).json();return $t(e)};function $t(a){const t={},n=[];for(let e of a){const i=t[e.country_code]=t[e.country_code]??{country_name:e.country_name,country_code:e.country_code,quantity_sold:0,sales_amount:0,total_costs:0,total_sales:0};i.quantity_sold+=e.quantity_sold,i.sales_amount+=e.sales_amount,i.total_costs+=e.total_costs,i.total_sales+=e.total_sales;let s=n.find(y=>y.country_code===e.country_code&&y.city===e.city);s||(s={country_code:e.country_code,country_name:e.country_name,city:e.city,quantity_sold:0,sales_amount:0,total_costs:0,total_sales:0},n.push(s)),s.quantity_sold+=e.quantity_sold,s.sales_amount+=e.sales_amount,s.total_costs+=e.total_costs,s.total_sales+=e.total_sales}return{detail:a,byCity:n,byCountry:Object.keys(t).map(e=>t[e])}}const de=Object.freeze(Object.defineProperty({__proto__:null,load:Vt},Symbol.toStringTag,{value:"Module"}));var Y;class Lt{constructor(){vt(this,Y,x(!0))}get noViewportInChildren(){return o(et(this,Y))}set noViewportInChildren(t){f(et(this,Y),d(t))}}Y=new WeakMap;const wt=new Lt,G=new Intl.NumberFormat(navigator==null?void 0:navigator.language,{style:"currency",currency:"USD",currencyDisplay:"narrowSymbol"});function q(a){return new Intl.NumberFormat(navigator==null?void 0:navigator.language,{style:"decimal",minimumFractionDigits:a,maximumFractionDigits:a})}const Wt=new Intl.NumberFormat(navigator==null?void 0:navigator.language,{style:"percent",minimumFractionDigits:0,maximumFractionDigits:2});var Rt=k('<div class="px-1"><!></div>');function dt(a,t){E(t,!0);var n=Rt(),e=j(n);yt(e,()=>t.children),I(n),m(a,n),z()}var Nt=k('<div class="title fw-bold px-2 py-1 rounded-start svelte-pyu8kv"> </div>');function ut(a,t){var n=Nt(),e=j(n,!0);I(n),$(()=>Q(e,t.title)),m(a,n)}var Ot=k('<button type="button" class="btn btn-sm btn-info" title="Click to show additional information" aria-label="Click to show additional information" data-bs-toggle="offcanvas"><i class="bi bi-info-circle"></i></button>'),Gt=k('<div class="btn-toolbar my-2 py-1 px-1 gap-2 border border-1 rounded"><!> <div class="input-group input-group-sm"><span class="input-group-text" title="Row Options:"><i class="bi bi-list-check"></i></span> <div class="btn-group btn-group-sm"><input type="checkbox" class="btn-check"> <label class="btn btn-outline-primary rounded-0">Striped</label> <input type="checkbox" class="btn-check"> <label class="btn btn-outline-primary">Row Tracking</label> <input type="checkbox" class="btn-check"> <label class="btn btn-outline-primary">Selection Highlight</label></div></div> <div class="input-group input-group-sm"><span title="Borders:" class="input-group-text"><i class="bi bi-border-all"></i></span> <div class="btn-group btn-group-sm"><input type="checkbox" class="btn-check"> <label class="btn btn-outline-primary rounded-0" title="Row borders"><i class="bi bi-border-bottom"></i></label> <input type="checkbox" class="btn-check"> <label class="btn btn-outline-primary" title="Column borders"><i class="bi bi-border-right"></i></label></div></div> <!></div>');function pt(a,t){E(t,!0);const n=[];let e=ft(t,"options",15),i=x(d([]));const s=xt();Tt(()=>{e(e().gridLines=o(i).reduce((v,P)=>v|P,H.None),!0)});var y=Gt(),D=j(y);U(D,()=>t.moreInfoTarget,v=>{var P=Ot();$(()=>C(P,"data-bs-target",`#${t.moreInfoTarget??""}`)),m(v,P)});var p=u(D,2),R=u(j(p),2),V=j(R);J(V),C(V,"id",`${s??""}_striped`);var O=u(V,2);C(O,"for",`${s??""}_striped`);var g=u(O,2);J(g),C(g,"id",`${s??""}_rowTracking`);var h=u(g,2);C(h,"for",`${s??""}_rowTracking`);var l=u(h,2);J(l),C(l,"id",`${s??""}_rowSelectionHighlight`);var r=u(l,2);C(r,"for",`${s??""}_rowSelectionHighlight`),I(R),I(p);var w=u(p,2),L=u(j(w),2),_=j(L);J(_),C(_,"id",`${s??""}_rowGridLine`);var S,N=u(_,2);C(N,"for",`${s??""}_rowGridLine`);var F=u(N,2);J(F),C(F,"id",`${s??""}_colGridLine`);var Z,b=u(F,2);C(b,"for",`${s??""}_colGridLine`),I(L),I(w);var c=u(w,2);yt(c,()=>t.children??T),I(y),$(()=>{S!==(S=H.Row)&&(_.value=(_.__value=H.Row)==null?"":H.Row),Z!==(Z=H.Column)&&(F.value=(F.__value=H.Column)==null?"":H.Column)}),at(V,()=>e().striping,v=>e(e().striping=v,!0)),at(g,()=>e().rowTracking,v=>e(e().rowTracking=v,!0)),at(l,()=>e().rowSelectionHighlight,v=>e(e().rowSelectionHighlight=v,!0)),ht(n,[],_,()=>o(i),v=>f(i,v)),ht(n,[],F,()=>o(i),v=>f(i,v)),m(a,y),z()}var qt=k('<!> <!> <hr class="border-3">',1);function Et(a,t){E(t,!0);let n=x(d([{key:"id",text:"ID",alignment:"start",pinnedFunctions:{}},{key:"country_code",text:"Country Code",alignment:"start",pinnedFunctions:{}},{key:"country_name",text:"Country",alignment:"start",pinnedFunctions:{}},{key:"city",text:"City",alignment:"start",pinnedFunctions:{}},{key:"month",text:"Month",alignment:"start",pinnedFunctions:{}},{key:"year",text:"Year",alignment:"start",pinnedFunctions:{}},{key:"sales_amount",text:"Sales Amount",dataType:"real-amount",numberFormatter:q(2),alignment:"end",pinnedFunctions:{}},{key:"product_category",text:"Product Category",width:12,alignment:"start",pinnedFunctions:{}},{key:"quantity_sold",text:"Quantity Sold",dataType:"int-amount",numberFormatter:q(0),alignment:"end",pinnedFunctions:{}},{key:"total_sales",text:"Total Sales",dataType:"currency",numberFormatter:G,alignment:"end",pinnedFunctions:{}},{key:"total_costs",text:"Total Costs",dataType:"currency",numberFormatter:G,alignment:"end",pinnedFunctions:{}},{key:"top_client",text:"Top Client",alignment:"start",pinnedFunctions:{}},{key:"top_client_fraction",text:"Top Client Fraction",width:13,dataType:"real-amount",numberFormatter:Wt,alignment:"center",pinnedFunctions:{}}])),e=x(d(rt(t.sourceData.detail.filter(p=>p.country_code===t.countryCode&&p.city===t.city)))),i=x(d({gridLines:H.None,rowSelectionHighlight:!0,rowTracking:!0,striping:!0}));var s=qt(),y=W(s);pt(y,{get options(){return o(i)},set options(p){f(i,d(p))},moreInfoTarget:"thirdLevelCanvas"});var D=u(y,2);it(D,{get columns(){return o(n)},set columns(g){f(n,d(g))},get data(){return o(e)},set data(g){f(e,d(g))},get noViewport(){return wt.noViewportInChildren},get rowTracking(){return o(i).rowTracking},get rowSelectionHighlight(){return o(i).rowSelectionHighlight},get striped(){return o(i).striping},get gridLines(){return o(i).gridLines},defaultWidth:12,controlColumn:{pinnedFunctions:{},alignment:"start",width:3,resizable:!1},class:"mb-5",caption:g=>{ut(g,{get title(){return`Raw Data: ${t.city??""}`}})},headerCell:(g,h=T)=>{st(g,{get col(){return h().col},set col(l){h().col=l}})},controlHeaderCell:g=>{lt(g,{get columns(){return o(n)},set columns(h){f(n,d(h))}})},dataCell:(g,h=T)=>{dt(g,{children:(l,r)=>{var w=X(),L=W(w);U(L,()=>h().col.numberFormatter,_=>{var S=ot(()=>h().getFn(h().row));ct(_,{get value(){return o(S)},get formatter(){return h().col.numberFormatter}})},_=>{var S=nt();$(()=>Q(S,h().getFn(h().row))),m(_,S)}),m(l,w)},$$slots:{default:!0}})},$$slots:{caption:!0,headerCell:!0,controlHeaderCell:!0,dataCell:!0}}),bt(2),m(a,s),z()}var zt=(a,t)=>t(t().wjdv.expanded=!t().wjdv.expanded,!0),Pt=k('<button type="button" class="btn btn-neutral btn-sm"><i></i></button>');function _t(a,t){E(t,!0);let n=ft(t,"row",15);var e=Pt();e.__click=[zt,n];var i=j(e);I(e),$(()=>{C(e,"aria-label",n().wjdv.expanded?"contract":"expand"),Dt(i,`bi bi-chevron-bar-${(n().wjdv.expanded?"contract":"expand")??""}`)}),m(a,e),z()}Ft(["click"]);var At=k('<!> <!> <hr class="border-3">',1);function Bt(a,t){E(t,!0);let n=x(d([{key:"city",text:"City",alignment:"start",dataType:"string",pinnedFunctions:{}},{key:"sales_amount",text:"Total Amount",alignment:"end",dataType:"real-amount",numberFormatter:q(2),pinnedFunctions:{}},{key:"quantity_sold",text:"Total Quantity",alignment:"end",dataType:"int-amount",numberFormatter:q(0),pinnedFunctions:{}},{key:"total_sales",text:"Total Sales",alignment:"end",dataType:"currency",numberFormatter:G,pinnedFunctions:{}},{key:"total_costs",text:"Total Costs",alignment:"end",dataType:"currency",numberFormatter:G,pinnedFunctions:{}}])),e=x(d(rt(t.sourceData.byCity.filter(p=>p.country_code===t.countryCode),p=>`${p.country_code}_${p.city}`))),i=x(d({gridLines:H.None,rowSelectionHighlight:!0,rowTracking:!0,striping:!0}));var s=At(),y=W(s);pt(y,{get options(){return o(i)},set options(p){f(i,d(p))},moreInfoTarget:"secondLevelCanvas"});var D=u(y,2);it(D,{get columns(){return o(n)},set columns(l){f(n,d(l))},get data(){return o(e)},set data(l){f(e,d(l))},get noViewport(){return wt.noViewportInChildren},get rowTracking(){return o(i).rowTracking},get rowSelectionHighlight(){return o(i).rowSelectionHighlight},get striped(){return o(i).striping},get gridLines(){return o(i).gridLines},defaultWidth:12,controlColumn:{width:3,alignment:"center",resizable:!1,pinnedFunctions:{}},class:"mb-5",style:"z-index: 5",caption:l=>{ut(l,{get title(){return`Per-City Summary: ${t.countryName??""}`}})},headerCell:(l,r=T)=>{st(l,{get col(){return r().col},set col(w){r().col=w}})},dataCell:(l,r=T)=>{dt(l,{children:(w,L)=>{var _=X(),S=W(_);U(S,()=>r().col.dataType!=="string",N=>{var F=ot(()=>r().getFn(r().row));ct(N,{get value(){return o(F)},get formatter(){return r().col.numberFormatter}})},N=>{var F=nt();$(()=>Q(F,r().getFn(r().row))),m(N,F)}),m(w,_)},$$slots:{default:!0}})},controlHeaderCell:l=>{lt(l,{get columns(){return o(n)},set columns(r){f(n,d(r))}})},controlDataCell:(l,r=T)=>{_t(l,{get row(){return r().row},set row(w){r().row=w}})},rowExpansion:(l,r=T)=>{Et(l,{get sourceData(){return t.sourceData},get countryCode(){return t.countryCode},get city(){return r().row.city}})},$$slots:{caption:!0,headerCell:!0,dataCell:!0,controlHeaderCell:!0,controlDataCell:!0,rowExpansion:!0}}),bt(2),m(a,s),z()}function Mt(){const a={};return a.gridLines=H.None,a.rowSelectionHighlight=!0,a.rowTracking=!0,a.striping=!0,a}var Jt=k(`<div class="offcanvas offcanvas-end bg-info bg-glass svelte-1i880sp" id="firstLevelCanvas" data-bs-backdrop="false"><div class="offcanvas-header"><h3 class="offcanvas-title">Worldwide Sales Rollup Demo</h3></div> <div class="offcanvas-body"><p>This table shows the rolled-up summary of (ficticious) sales data.  The record feed is random and courtesy 
            of <a href="https://www.mockaroo.com" target="_blank">Mockaroo</a>.  The original records can be seen at 
            the third level.</p> <p>The toolbar above the table can be used to turn <span class="code svelte-1i880sp">WjDataView</span>'s features on and 
            off.  As data is drilled down, more toolbars will appear for the additional <span class="code svelte-1i880sp">WjDataView</span> components that show the more detailed data.</p> <h4>Drilldown Features</h4> <p>Currently there is one significant feature that effects how users experience data drilldown using <span class="code svelte-1i880sp">WjDataView</span>:  The <span class="code svelte-1i880sp">noViewport</span> property.</p> <p>Instances of <span class="code svelte-1i880sp">WjDataView</span> provide their own viewport.  The viewport is the 
            container in charge of providing horizontal and vertical scrollbars to the component so all data can be 
            examined.  Furthermore, the header row is configured to be sticky.  This means that the header row will 
            "stick" to the viewport when said viewport is scrolled vertically.</p> <p>But what happens when the viewport disappears?  The header row will now stick to the next available 
            viewport, and that's the viewport of the parent <span class="code svelte-1i880sp">WjDataView</span> component.  The net 
            result is that the header row of child <span class="code svelte-1i880sp">WjDataView</span> components are now in the 
            position of overlapping the parent's header row.</p> <h5>How To Experience the effect of <span class="code svelte-1i880sp">noViewport</span>?</h5> <p>Simply expand a row or rows until the vertical scrollbar has enough room to make the the header row of a 
            child <span class="code svelte-1i880sp">WjDataView</span> component reach the top of the parent's viewport.</p> <p>In order to experience the difference, the "no viewport" setting can be turned off by using the top 
            toolbar.  The option is the button with the <i class="bi bi-eye-slash"></i> icon.</p></div></div>`);function Qt(a){var t=Jt();m(a,t)}var Ut=k(`<div class="offcanvas offcanvas-end bg-info bg-glass svelte-1i880sp" id="secondLevelCanvas" data-bs-backdrop="false"><div class="offcanvas-header"><h3 class="offcanvas-title">Worldwide Sales Rollup Demo</h3></div> <div class="offcanvas-body"><p>This is a second-level <span class="code svelte-1i880sp">WjDataView</span> component.  It shows the same information as 
            the first level, but rolled up to city, not country.</p> <p>Feel free to scroll up and down and turn table features on and off.  Do you have an idea or suggestion to 
            make things better?  Stop by the <a href="https://github.com/WJSoftware/wjfe-dataview/issues" target="_blank">project's issues page</a> and open a new issue.</p></div></div>`);function Yt(a){var t=Ut();m(a,t)}var Kt=k(`<div class="offcanvas offcanvas-end bg-info bg-glass svelte-1i880sp" id="thirdLevelCanvas" data-bs-backdrop="false"><div class="offcanvas-header"><h3 class="offcanvas-title">Worldwide Sales Rollup Demo</h3></div> <div class="offcanvas-body"><p>This is the third and last level of data.  It shows the raw records obtained from the mocking service, <a href="https://www.mockaroo.com" target="_blank">Mockaroo</a>.</p> <p>This demo queries for this raw data in Sveltekit's <span class="code svelte-1i880sp">+page.ts</span> code file, and then 
            calculates the rollups.</p> <p>Would you like to experiment a bit?  Simply for the project, then run <span class="code svelte-1i880sp">npm ci</span>, 
            and then run <span class="code svelte-1i880sp">npm run dev</span>.  The sales demo page is at <span class="code svelte-1i880sp">/routes/sales</span>.  For example, you could try rolling the data up differently, say, 
            by customer or by product category.  You could also create an alternative data feed, either from real data 
            or faked data.</p> <p class="display-6 text-center mt-5">Don't forget to give the project a star on <a href="https://github.com/WJSoftware/wjfe-dataview" target="_blank">GitHub <i class="bi bi-github"></i></a>!</p></div></div>`);function Xt(a){var t=Kt();m(a,t)}var Zt=k('<div class="input-group input-group-sm"><span class="input-group-text" title="Drilldown:"><i class="bi bi-bar-chart-steps"></i></span> <input type="checkbox" id="noViewportInChildren" class="btn-check"> <label for="noViewportInChildren" class="btn btn-outline-primary btn-sm" title="No viewports in children"><i class="bi bi-eye-slash"></i></label></div>'),te=k(`<img alt="Country's flag"> `,1),ee=k('<hgroup class="mb-3"><h1>WjDataView Demo</h1> <h4>Worldwide Sales Data Rollup</h4></hgroup> <div class="d-flex flex-column flex-fill"><!> <div class="flex-fill position-relative"><!> <!></div></div> <!> <!> <!>',1);function ue(a,t){E(t,!0);let n=x(d(Mt())),e=x(d([{key:"country",text:"Country",alignment:"start",get:s,pinnedFunctions:{}},{key:"sales_amount",text:"Total Amount",alignment:"end",dataType:"real-amount",numberFormatter:q(2),pinnedFunctions:{}},{key:"quantity_sold",text:"Total Quantity",alignment:"end",dataType:"int-amount",numberFormatter:q(0),pinnedFunctions:{}},{key:"total_sales",text:"Total Sales",alignment:"end",dataType:"currency",numberFormatter:G,pinnedFunctions:{}},{key:"total_costs",text:"Total Costs",alignment:"end",dataType:"currency",numberFormatter:G,pinnedFunctions:{}}])),i=x(d(rt(t.data.byCountry,r=>r.country_code)));function s(r){return`${r.country_name} (${r.country_code})`}var y=ee(),D=u(W(y),2),p=j(D);pt(p,{get options(){return o(n)},set options(r){f(n,d(r))},moreInfoTarget:"firstLevelCanvas",children:(r,w)=>{var L=Zt();m(r,L)},$$slots:{default:!0}});var R=u(p,2),V=j(R);St(V,{get theme(){return jt.currentTheme},children:(r,w)=>{it(r,{get columns(){return o(e)},set columns(b){f(e,d(b))},get data(){return o(i)},set data(b){f(i,d(b))},get striped(){return o(n).striping},get rowTracking(){return o(n).rowTracking},get rowSelectionHighlight(){return o(n).rowSelectionHighlight},get gridLines(){return o(n).gridLines},defaultWidth:15,class:"position-absolute top-0 bottom-0",controlColumn:{width:3,resizable:!1,alignment:"center",pinnedFunctions:{}},style:"z-index: 5",caption:b=>{ut(b,{title:"Global Overview"})},controlHeaderCell:b=>{lt(b,{get columns(){return o(e)},set columns(c){f(e,d(c))}})},controlDataCell:(b,c=T)=>{_t(b,{get row(){return c().row},set row(v){c().row=v}})},rowExpansion:(b,c=T)=>{Bt(b,{get sourceData(){return t.data},get countryCode(){return c().row.country_code},get countryName(){return c().row.country_name}})},headerCell:(b,c=T)=>{st(b,{get col(){return c().col},set col(v){c().col=v}})},dataCell:(b,c=T)=>{dt(b,{children:(v,P)=>{var gt=X(),Ct=W(gt);U(Ct,()=>c().col.key==="country",tt=>{var A=te(),B=W(A),M=u(B);$(()=>Q(M,` ${c().getFn(c().row)??""}`)),$(()=>{C(B,"src",`https://countryflagsapi.netlify.app/flag/${c().row.country_code??""}.svg`),It(B,"height","1em")}),m(tt,A)},tt=>{var A=X(),B=W(A);U(B,()=>c().col.dataType!=="string",M=>{var K=ot(()=>c().getFn(c().row));ct(M,{get value(){return o(K)},get formatter(){return c().col.numberFormatter}})},M=>{var K=nt();$(()=>Q(K,c().getFn(c().row))),m(M,K)},!0),m(tt,A)}),m(v,gt)},$$slots:{default:!0}})},$$slots:{caption:!0,controlHeaderCell:!0,controlDataCell:!0,rowExpansion:!0,headerCell:!0,dataCell:!0}})},$$slots:{default:!0}});var O=u(V,2);Ht(O,{editUrl:"https://github.com/WJSoftware/wjfe-dataview/blob/main/src/routes/sales/%2Bpage.svelte"}),I(R),I(D);var g=u(D,2);Qt(g);var h=u(g,2);Yt(h);var l=u(h,2);Xt(l),m(a,y),z()}export{ue as component,de as universal};
